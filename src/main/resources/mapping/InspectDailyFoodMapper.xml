<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.upc.dao.InspectDailyFoodMapper">
  <resultMap id="BaseResultMap" type="com.example.upc.dataobject.InspectDailyFood">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 19 22:37:14 CST 2019.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="check_type" jdbcType="INTEGER" property="checkType" />
    <result column="check_object_id" jdbcType="INTEGER" property="checkObjectId" />
    <result column="check_object" jdbcType="VARCHAR" property="checkObject" />
    <result column="industry" jdbcType="INTEGER" property="industry" />
    <result column="region" jdbcType="INTEGER" property="region" />
    <result column="grid" jdbcType="INTEGER" property="grid" />
    <result column="check_address" jdbcType="VARCHAR" property="checkAddress" />
    <result column="ok_number" jdbcType="VARCHAR" property="okNumber" />
    <result column="charge_person" jdbcType="VARCHAR" property="chargePerson" />
    <result column="check_organ" jdbcType="INTEGER" property="checkOrgan" />
    <result column="contact_phone" jdbcType="VARCHAR" property="contactPhone" />
    <result column="entourage" jdbcType="VARCHAR" property="entourage" />
    <result column="supervisor_id" jdbcType="VARCHAR" property="supervisorId" />
    <result column="supervisor" jdbcType="VARCHAR" property="supervisor" />
    <result column="supervisor_number" jdbcType="VARCHAR" property="supervisorNumber" />
    <result column="check_date" jdbcType="VARCHAR" property="checkDate" />
    <result column="check_start_hour" jdbcType="VARCHAR" property="checkStartHour" />
    <result column="check_start_minute" jdbcType="VARCHAR" property="checkStartMinute" />
    <result column="check_end_hour" jdbcType="VARCHAR" property="checkEndHour" />
    <result column="check_end_minute" jdbcType="VARCHAR" property="checkEndMinute" />
    <result column="last_check_time" jdbcType="TIMESTAMP" property="lastCheckTime" />
    <result column="check_count" jdbcType="INTEGER" property="checkCount" />
    <result column="check_frequence" jdbcType="INTEGER" property="checkFrequence" />
    <result column="check_total" jdbcType="INTEGER" property="checkTotal" />
    <result column="check_result" jdbcType="VARCHAR" property="checkResult" />
    <result column="result_process" jdbcType="VARCHAR" property="resultProcess" />
    <result column="problem" jdbcType="VARCHAR" property="problem" />
    <result column="disposal_measures" jdbcType="VARCHAR" property="disposalMeasures" />
    <result column="first_enforcer" jdbcType="VARCHAR" property="firstEnforcer" />
    <result column="second_enforcer" jdbcType="VARCHAR" property="secondEnforcer" />
    <result column="document" jdbcType="VARCHAR" property="document" />
    <result column="status" jdbcType="INTEGER" property="status" />
    <result column="operator" jdbcType="VARCHAR" property="operator" />
    <result column="operator_ip" jdbcType="VARCHAR" property="operatorIp" />
    <result column="operator_time" jdbcType="TIMESTAMP" property="operatorTime" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 19 22:37:14 CST 2019.
    -->
    id, check_type, check_object_id, check_object, industry, region, grid, check_address, 
    ok_number, charge_person, check_organ, contact_phone, entourage, supervisor_id, supervisor, 
    supervisor_number, check_date, check_start_hour, check_start_minute, check_end_hour, 
    check_end_minute, last_check_time, check_count, check_frequence, check_total, check_result, 
    result_process, problem, disposal_measures, first_enforcer, second_enforcer, document, 
    status, operator, operator_ip, operator_time
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 19 22:37:14 CST 2019.
    -->
    select 
    <include refid="Base_Column_List" />
    from inspect_daily_food
    where id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 19 22:37:14 CST 2019.
    -->
    delete from inspect_daily_food
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.example.upc.dataobject.InspectDailyFood">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 19 22:37:14 CST 2019.
    -->
    insert into inspect_daily_food (id, check_type, check_object_id, 
      check_object, industry, region, 
      grid, check_address, ok_number, 
      charge_person, check_organ, contact_phone, 
      entourage, supervisor_id, supervisor, 
      supervisor_number, check_date, check_start_hour, 
      check_start_minute, check_end_hour, check_end_minute, 
      last_check_time, check_count, check_frequence, 
      check_total, check_result, result_process, 
      problem, disposal_measures, first_enforcer, 
      second_enforcer, document, status, 
      operator, operator_ip, operator_time
      )
    values (#{id,jdbcType=INTEGER}, #{checkType,jdbcType=INTEGER}, #{checkObjectId,jdbcType=INTEGER}, 
      #{checkObject,jdbcType=VARCHAR}, #{industry,jdbcType=INTEGER}, #{region,jdbcType=INTEGER}, 
      #{grid,jdbcType=INTEGER}, #{checkAddress,jdbcType=VARCHAR}, #{okNumber,jdbcType=VARCHAR}, 
      #{chargePerson,jdbcType=VARCHAR}, #{checkOrgan,jdbcType=INTEGER}, #{contactPhone,jdbcType=VARCHAR}, 
      #{entourage,jdbcType=VARCHAR}, #{supervisorId,jdbcType=VARCHAR}, #{supervisor,jdbcType=VARCHAR}, 
      #{supervisorNumber,jdbcType=VARCHAR}, #{checkDate,jdbcType=VARCHAR}, #{checkStartHour,jdbcType=VARCHAR}, 
      #{checkStartMinute,jdbcType=VARCHAR}, #{checkEndHour,jdbcType=VARCHAR}, #{checkEndMinute,jdbcType=VARCHAR}, 
      #{lastCheckTime,jdbcType=TIMESTAMP}, #{checkCount,jdbcType=INTEGER}, #{checkFrequence,jdbcType=INTEGER}, 
      #{checkTotal,jdbcType=INTEGER}, #{checkResult,jdbcType=VARCHAR}, #{resultProcess,jdbcType=VARCHAR}, 
      #{problem,jdbcType=VARCHAR}, #{disposalMeasures,jdbcType=VARCHAR}, #{firstEnforcer,jdbcType=VARCHAR}, 
      #{secondEnforcer,jdbcType=VARCHAR}, #{document,jdbcType=VARCHAR}, #{status,jdbcType=INTEGER}, 
      #{operator,jdbcType=VARCHAR}, #{operatorIp,jdbcType=VARCHAR}, #{operatorTime,jdbcType=TIMESTAMP}
      )
  </insert>
  <insert id="insertSelective" useGeneratedKeys="true" keyProperty="id" keyColumn="id" parameterType="com.example.upc.dataobject.InspectDailyFood">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 19 22:37:14 CST 2019.
    -->
    insert into inspect_daily_food
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="checkType != null">
        check_type,
      </if>
      <if test="checkObjectId != null">
        check_object_id,
      </if>
      <if test="checkObject != null">
        check_object,
      </if>
      <if test="industry != null">
        industry,
      </if>
      <if test="region != null">
        region,
      </if>
      <if test="grid != null">
        grid,
      </if>
      <if test="checkAddress != null">
        check_address,
      </if>
      <if test="okNumber != null">
        ok_number,
      </if>
      <if test="chargePerson != null">
        charge_person,
      </if>
      <if test="checkOrgan != null">
        check_organ,
      </if>
      <if test="contactPhone != null">
        contact_phone,
      </if>
      <if test="entourage != null">
        entourage,
      </if>
      <if test="supervisorId != null">
        supervisor_id,
      </if>
      <if test="supervisor != null">
        supervisor,
      </if>
      <if test="supervisorNumber != null">
        supervisor_number,
      </if>
      <if test="checkDate != null">
        check_date,
      </if>
      <if test="checkStartHour != null">
        check_start_hour,
      </if>
      <if test="checkStartMinute != null">
        check_start_minute,
      </if>
      <if test="checkEndHour != null">
        check_end_hour,
      </if>
      <if test="checkEndMinute != null">
        check_end_minute,
      </if>
      <if test="lastCheckTime != null">
        last_check_time,
      </if>
      <if test="checkCount != null">
        check_count,
      </if>
      <if test="checkFrequence != null">
        check_frequence,
      </if>
      <if test="checkTotal != null">
        check_total,
      </if>
      <if test="checkResult != null">
        check_result,
      </if>
      <if test="resultProcess != null">
        result_process,
      </if>
      <if test="problem != null">
        problem,
      </if>
      <if test="disposalMeasures != null">
        disposal_measures,
      </if>
      <if test="firstEnforcer != null">
        first_enforcer,
      </if>
      <if test="secondEnforcer != null">
        second_enforcer,
      </if>
      <if test="document != null">
        document,
      </if>
      <if test="status != null">
        status,
      </if>
      <if test="operator != null">
        operator,
      </if>
      <if test="operatorIp != null">
        operator_ip,
      </if>
      <if test="operatorTime != null">
        operator_time,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=INTEGER},
      </if>
      <if test="checkType != null">
        #{checkType,jdbcType=INTEGER},
      </if>
      <if test="checkObjectId != null">
        #{checkObjectId,jdbcType=INTEGER},
      </if>
      <if test="checkObject != null">
        #{checkObject,jdbcType=VARCHAR},
      </if>
      <if test="industry != null">
        #{industry,jdbcType=INTEGER},
      </if>
      <if test="region != null">
        #{region,jdbcType=INTEGER},
      </if>
      <if test="grid != null">
        #{grid,jdbcType=INTEGER},
      </if>
      <if test="checkAddress != null">
        #{checkAddress,jdbcType=VARCHAR},
      </if>
      <if test="okNumber != null">
        #{okNumber,jdbcType=VARCHAR},
      </if>
      <if test="chargePerson != null">
        #{chargePerson,jdbcType=VARCHAR},
      </if>
      <if test="checkOrgan != null">
        #{checkOrgan,jdbcType=INTEGER},
      </if>
      <if test="contactPhone != null">
        #{contactPhone,jdbcType=VARCHAR},
      </if>
      <if test="entourage != null">
        #{entourage,jdbcType=VARCHAR},
      </if>
      <if test="supervisorId != null">
        #{supervisorId,jdbcType=VARCHAR},
      </if>
      <if test="supervisor != null">
        #{supervisor,jdbcType=VARCHAR},
      </if>
      <if test="supervisorNumber != null">
        #{supervisorNumber,jdbcType=VARCHAR},
      </if>
      <if test="checkDate != null">
        #{checkDate,jdbcType=VARCHAR},
      </if>
      <if test="checkStartHour != null">
        #{checkStartHour,jdbcType=VARCHAR},
      </if>
      <if test="checkStartMinute != null">
        #{checkStartMinute,jdbcType=VARCHAR},
      </if>
      <if test="checkEndHour != null">
        #{checkEndHour,jdbcType=VARCHAR},
      </if>
      <if test="checkEndMinute != null">
        #{checkEndMinute,jdbcType=VARCHAR},
      </if>
      <if test="lastCheckTime != null">
        #{lastCheckTime,jdbcType=TIMESTAMP},
      </if>
      <if test="checkCount != null">
        #{checkCount,jdbcType=INTEGER},
      </if>
      <if test="checkFrequence != null">
        #{checkFrequence,jdbcType=INTEGER},
      </if>
      <if test="checkTotal != null">
        #{checkTotal,jdbcType=INTEGER},
      </if>
      <if test="checkResult != null">
        #{checkResult,jdbcType=VARCHAR},
      </if>
      <if test="resultProcess != null">
        #{resultProcess,jdbcType=VARCHAR},
      </if>
      <if test="problem != null">
        #{problem,jdbcType=VARCHAR},
      </if>
      <if test="disposalMeasures != null">
        #{disposalMeasures,jdbcType=VARCHAR},
      </if>
      <if test="firstEnforcer != null">
        #{firstEnforcer,jdbcType=VARCHAR},
      </if>
      <if test="secondEnforcer != null">
        #{secondEnforcer,jdbcType=VARCHAR},
      </if>
      <if test="document != null">
        #{document,jdbcType=VARCHAR},
      </if>
      <if test="status != null">
        #{status,jdbcType=INTEGER},
      </if>
      <if test="operator != null">
        #{operator,jdbcType=VARCHAR},
      </if>
      <if test="operatorIp != null">
        #{operatorIp,jdbcType=VARCHAR},
      </if>
      <if test="operatorTime != null">
        #{operatorTime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.example.upc.dataobject.InspectDailyFood">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 19 22:37:14 CST 2019.
    -->
    update inspect_daily_food
    <set>
      <if test="checkType != null">
        check_type = #{checkType,jdbcType=INTEGER},
      </if>
      <if test="checkObjectId != null">
        check_object_id = #{checkObjectId,jdbcType=INTEGER},
      </if>
      <if test="checkObject != null">
        check_object = #{checkObject,jdbcType=VARCHAR},
      </if>
      <if test="industry != null">
        industry = #{industry,jdbcType=INTEGER},
      </if>
      <if test="region != null">
        region = #{region,jdbcType=INTEGER},
      </if>
      <if test="grid != null">
        grid = #{grid,jdbcType=INTEGER},
      </if>
      <if test="checkAddress != null">
        check_address = #{checkAddress,jdbcType=VARCHAR},
      </if>
      <if test="okNumber != null">
        ok_number = #{okNumber,jdbcType=VARCHAR},
      </if>
      <if test="chargePerson != null">
        charge_person = #{chargePerson,jdbcType=VARCHAR},
      </if>
      <if test="checkOrgan != null">
        check_organ = #{checkOrgan,jdbcType=INTEGER},
      </if>
      <if test="contactPhone != null">
        contact_phone = #{contactPhone,jdbcType=VARCHAR},
      </if>
      <if test="entourage != null">
        entourage = #{entourage,jdbcType=VARCHAR},
      </if>
      <if test="supervisorId != null">
        supervisor_id = #{supervisorId,jdbcType=VARCHAR},
      </if>
      <if test="supervisor != null">
        supervisor = #{supervisor,jdbcType=VARCHAR},
      </if>
      <if test="supervisorNumber != null">
        supervisor_number = #{supervisorNumber,jdbcType=VARCHAR},
      </if>
      <if test="checkDate != null">
        check_date = #{checkDate,jdbcType=VARCHAR},
      </if>
      <if test="checkStartHour != null">
        check_start_hour = #{checkStartHour,jdbcType=VARCHAR},
      </if>
      <if test="checkStartMinute != null">
        check_start_minute = #{checkStartMinute,jdbcType=VARCHAR},
      </if>
      <if test="checkEndHour != null">
        check_end_hour = #{checkEndHour,jdbcType=VARCHAR},
      </if>
      <if test="checkEndMinute != null">
        check_end_minute = #{checkEndMinute,jdbcType=VARCHAR},
      </if>
      <if test="lastCheckTime != null">
        last_check_time = #{lastCheckTime,jdbcType=TIMESTAMP},
      </if>
      <if test="checkCount != null">
        check_count = #{checkCount,jdbcType=INTEGER},
      </if>
      <if test="checkFrequence != null">
        check_frequence = #{checkFrequence,jdbcType=INTEGER},
      </if>
      <if test="checkTotal != null">
        check_total = #{checkTotal,jdbcType=INTEGER},
      </if>
      <if test="checkResult != null">
        check_result = #{checkResult,jdbcType=VARCHAR},
      </if>
      <if test="resultProcess != null">
        result_process = #{resultProcess,jdbcType=VARCHAR},
      </if>
      <if test="problem != null">
        problem = #{problem,jdbcType=VARCHAR},
      </if>
      <if test="disposalMeasures != null">
        disposal_measures = #{disposalMeasures,jdbcType=VARCHAR},
      </if>
      <if test="firstEnforcer != null">
        first_enforcer = #{firstEnforcer,jdbcType=VARCHAR},
      </if>
      <if test="secondEnforcer != null">
        second_enforcer = #{secondEnforcer,jdbcType=VARCHAR},
      </if>
      <if test="document != null">
        document = #{document,jdbcType=VARCHAR},
      </if>
      <if test="status != null">
        status = #{status,jdbcType=INTEGER},
      </if>
      <if test="operator != null">
        operator = #{operator,jdbcType=VARCHAR},
      </if>
      <if test="operatorIp != null">
        operator_ip = #{operatorIp,jdbcType=VARCHAR},
      </if>
      <if test="operatorTime != null">
        operator_time = #{operatorTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.example.upc.dataobject.InspectDailyFood">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 19 22:37:14 CST 2019.
    -->
    update inspect_daily_food
    set check_type = #{checkType,jdbcType=INTEGER},
      check_object_id = #{checkObjectId,jdbcType=INTEGER},
      check_object = #{checkObject,jdbcType=VARCHAR},
      industry = #{industry,jdbcType=INTEGER},
      region = #{region,jdbcType=INTEGER},
      grid = #{grid,jdbcType=INTEGER},
      check_address = #{checkAddress,jdbcType=VARCHAR},
      ok_number = #{okNumber,jdbcType=VARCHAR},
      charge_person = #{chargePerson,jdbcType=VARCHAR},
      check_organ = #{checkOrgan,jdbcType=INTEGER},
      contact_phone = #{contactPhone,jdbcType=VARCHAR},
      entourage = #{entourage,jdbcType=VARCHAR},
      supervisor_id = #{supervisorId,jdbcType=VARCHAR},
      supervisor = #{supervisor,jdbcType=VARCHAR},
      supervisor_number = #{supervisorNumber,jdbcType=VARCHAR},
      check_date = #{checkDate,jdbcType=VARCHAR},
      check_start_hour = #{checkStartHour,jdbcType=VARCHAR},
      check_start_minute = #{checkStartMinute,jdbcType=VARCHAR},
      check_end_hour = #{checkEndHour,jdbcType=VARCHAR},
      check_end_minute = #{checkEndMinute,jdbcType=VARCHAR},
      last_check_time = #{lastCheckTime,jdbcType=TIMESTAMP},
      check_count = #{checkCount,jdbcType=INTEGER},
      check_frequence = #{checkFrequence,jdbcType=INTEGER},
      check_total = #{checkTotal,jdbcType=INTEGER},
      check_result = #{checkResult,jdbcType=VARCHAR},
      result_process = #{resultProcess,jdbcType=VARCHAR},
      problem = #{problem,jdbcType=VARCHAR},
      disposal_measures = #{disposalMeasures,jdbcType=VARCHAR},
      first_enforcer = #{firstEnforcer,jdbcType=VARCHAR},
      second_enforcer = #{secondEnforcer,jdbcType=VARCHAR},
      document = #{document,jdbcType=VARCHAR},
      status = #{status,jdbcType=INTEGER},
      operator = #{operator,jdbcType=VARCHAR},
      operator_ip = #{operatorIp,jdbcType=VARCHAR},
      operator_time = #{operatorTime,jdbcType=TIMESTAMP}
    where id = #{id,jdbcType=INTEGER}
  </update>

  <select id="countList" resultType="int">
    SELECT count(1)
    FROM inspect_daily_food
    where industry = #{industry,jdbcType=INTEGER}
    AND check_object_id IN (SELECT id FROM supervision_enterprise WHERE area IN
    <foreach collection="areaList" item="area" open="(" close=")" separator=",">#{area}</foreach>)
    <if test="search.checkDate != null and search.checkDate != ''">AND check_date LIKE CONCAT(#{search.checkDate},'%')</if>
    <if test="search.checkType != null">AND check_type = #{search.checkType}</if>
    <if test="search.region != null">AND region = #{search.region}</if>
    <if test="search.checkObject != null and search.checkObject != ''">AND check_object LIKE CONCAT('%',#{search.checkObject},'%')</if>
    <if test="search.supervisor != null and search.supervisor != ''">AND supervisor LIKE CONCAT('%',#{search.supervisor},'%')</if>
    <if test="search.status != null">AND status = #{search.status}</if>
    <if test="search.checkFrequence != null">AND check_frequence = #{search.checkFrequence}</if>
    <if test="search.checkResult != null and search.checkResult != ''">AND check_result = #{search.checkResult}</if>
    <if test="search.resultProcess != null and search.resultProcess != ''">AND result_process = #{search.resultProcess}</if>
    <if test="search.checkCount != null">AND check_count = #{search.checkCount}</if>
  </select>

  <select id="getPage" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM inspect_daily_food
    WHERE industry = #{industry,jdbcType=INTEGER}
    AND check_object_id IN (SELECT id FROM supervision_enterprise WHERE area IN
    <foreach collection="areaList" item="area" open="(" close=")" separator=",">#{area}</foreach>)
    <if test="search.checkDate != null and search.checkDate != ''">AND check_date LIKE CONCAT(#{search.checkDate},'%')</if>
    <if test="search.checkType != null">AND check_type = #{search.checkType}</if>
    <if test="search.region != null">AND region = #{search.region}</if>
    <if test="search.checkObject != null and search.checkObject != ''">AND check_object LIKE CONCAT('%',#{search.checkObject},'%')</if>
    <if test="search.supervisor != null and search.supervisor != ''">AND supervisor LIKE CONCAT('%',#{search.supervisor},'%')</if>
    <if test="search.status != null">AND status = #{search.status}</if>
    <if test="search.checkFrequence != null">AND check_frequence = #{search.checkFrequence}</if>
    <if test="search.checkResult != null and search.checkResult != ''">AND check_result = #{search.checkResult}</if>
    <if test="search.resultProcess != null and search.resultProcess != ''">AND result_process = #{search.resultProcess}</if>
    <if test="search.checkCount != null">AND check_count = #{search.checkCount}</if>
    ORDER BY id DESC
    limit #{page.offset}, #{page.pageSize}
  </select>

  <select id="getCheckLastDate" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM inspect_daily_food
    WHERE check_object_id = #{objectId}
    ORDER BY check_date DESC
    limit 1
  </select>

  <select id="yearCheckNumber" resultType="int">
    SELECT count(1)
    FROM inspect_daily_food
    WHERE check_object_id = #{objectId}
    AND check_date LIKE CONCAT(#{year},'%')
  </select>

  <select id="countEnterpriseByAssessment" resultType="int">
    SELECT count(1) FROM (
    <if test="industry==5">SELECT a.*,b.id as a4_id FROM (</if>
    <if test="industry==3">SELECT a.*,b.id as a3_id FROM (</if>
    <if test="industry==2">SELECT a.*,b.id as a2_id FROM (</if>
    <if test="industry==2 or industry==3">SELECT a.* ,b.id as a1_id FROM(</if>
              SELECT id,enterprise_name,enterprise_scale,id_number,area,grid,regulators,is_stop,supervisor FROM supervision_enterprise WHERE year_assessment = #{yearAssessment}
    <if test="industry==2 or industry==3">  ) as a LEFT JOIN supervision_en_food_bu as b on a.id =b.enterprise_id
      <if test="industry==3 and industry!=2">AND b.business_format IN ('食品销售经营者（非连锁）','食品销售经营者（连锁）','食品销售经营者')</if>
      <if test="industry==2 and industry!=3">AND b.business_format IN ('餐饮服务经营者（非连锁）','餐饮服务经营者（连锁）','单位食堂','餐饮服务经营者')</if></if>
    <if test="industry==2">)as a LEFT JOIN supervision_en_common as b on a.id =b.enterprise_id</if>
    <if test="industry==3">)as a LEFT JOIN supervision_en_food_cir as b on a.id =b.enterprise_id</if>
    <if test="industry==5">)as a LEFT JOIN supervision_en_food_pro as b on a.id =b.enterprise_id</if>
    ) as a
    <trim prefix="WHERE" prefixOverrides="OR">
      <if test="industry==2 or industry==3">
        a1_id
      </if>
      <if test="industry==2">
        OR a2_id
      </if>
      <if test="industry==3">
        OR a3_id
      </if>
      <if test="industry==5">
        OR a4_id
      </if>
    </trim>
  </select>
  <select id="countByEnterprise" resultType="int">
    SELECT count(1) FROM (
    <if test="industry==5">SELECT a.*,b.id as a4_id FROM (</if>
    <if test="industry==3">SELECT a.*,b.id as a3_id FROM (</if>
    <if test="industry==2">SELECT a.*,b.id as a2_id FROM (</if>
    <if test="industry==2 or industry==3">SELECT a.* ,b.id as a1_id FROM(</if>
          SELECT id,enterprise_name,enterprise_scale,id_number,area,grid,regulators,is_stop,supervisor FROM supervision_enterprise WHERE area = #{area}
    <if test="industry==2 or industry==3">  ) as a LEFT JOIN supervision_en_food_bu as b on a.id =b.enterprise_id
      <if test="industry==3 and industry!=2">AND b.business_format IN ('食品销售经营者（非连锁）','食品销售经营者（连锁）','食品销售经营者')</if>
      <if test="industry==2 and industry!=3">AND b.business_format IN ('餐饮服务经营者（非连锁）','餐饮服务经营者（连锁）','单位食堂','餐饮服务经营者')</if></if>
    <if test="industry==2">)as a LEFT JOIN supervision_en_common as b on a.id =b.enterprise_id</if>
    <if test="industry==3">)as a LEFT JOIN supervision_en_food_cir as b on a.id =b.enterprise_id</if>
    <if test="industry==5">)as a LEFT JOIN supervision_en_food_pro as b on a.id =b.enterprise_id</if>
    ) as a
    <trim prefix="WHERE" prefixOverrides="OR">
      <if test="industry==2 or industry==3">
        a1_id
      </if>
      <if test="industry==2">
        OR a2_id
      </if>
      <if test="industry==3">
        OR a3_id
      </if>
      <if test="industry==5">
        OR a4_id
      </if>
    </trim>
  </select>
  <select id="countByCheckEnterprise" resultType="int">
    SELECT count(1) FROM (SELECT count(1) FROM inspect_daily_food WHERE industry = #{industry}
       AND check_date LIKE CONCAT(#{checkDate},'%')
         AND check_object_id IN (SELECT id FROM supervision_enterprise WHERE area = #{area}) GROUP BY check_object_id) as a
  </select>
  <select id="countShouldCheckNumber" resultType="java.lang.Integer">
    SELECT SUM(score) FROM (
    <if test="industry==5">SELECT a.*,b.id as a4_id FROM (</if>
    <if test="industry==3">SELECT a.*,b.id as a3_id FROM (</if>
    <if test="industry==2">SELECT a.*,b.id as a2_id FROM (</if>
    <if test="industry==2 or industry==3">SELECT a.* ,b.id as a1_id FROM(</if>
                       SELECT a.id,a.enterprise_name,b.score as score  FROM supervision_enterprise as a
                         LEFT JOIN inspect_assessment as b on a.year_assessment = b.assessment and a.area = #{area}
    <if test="industry==2 or industry==3">  ) as a LEFT JOIN supervision_en_food_bu as b on a.id =b.enterprise_id
      <if test="industry==3 and industry!=2">AND b.business_format IN ('食品销售经营者（非连锁）','食品销售经营者（连锁）','食品销售经营者')</if>
      <if test="industry==2 and industry!=3">AND b.business_format IN ('餐饮服务经营者（非连锁）','餐饮服务经营者（连锁）','单位食堂','餐饮服务经营者')</if></if>
    <if test="industry==2">)as a LEFT JOIN supervision_en_common as b on a.id =b.enterprise_id</if>
    <if test="industry==3">)as a LEFT JOIN supervision_en_food_cir as b on a.id =b.enterprise_id</if>
    <if test="industry==5">)as a LEFT JOIN supervision_en_food_pro as b on a.id =b.enterprise_id</if>
      ) as a
    <trim prefix="WHERE" prefixOverrides="OR">
      <if test="industry==2 or industry==3">
        a1_id
      </if>
      <if test="industry==2">
        OR a2_id
      </if>
      <if test="industry==3">
        OR a3_id
      </if>
      <if test="industry==5">
        OR a4_id
      </if>
    </trim>
  </select>
  <select id="countHaveCheckNumber" resultType="int">
    SELECT count(1) FROM inspect_daily_food WHERE industry = #{industry}
         AND check_date LIKE CONCAT(#{checkDate},'%')
            AND check_object_id IN ( SELECT id FROM supervision_enterprise WHERE area = #{area} )
  </select>
</mapper>