<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.upc.dao.SupervisionCaMapper">
  <resultMap id="BaseResultMap" type="com.example.upc.dataobject.SupervisionCa">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Sep 21 17:39:21 CST 2020.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="company_id" jdbcType="INTEGER" property="companyId" />
    <result column="company_name" jdbcType="VARCHAR" property="companyName" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="id_number" jdbcType="VARCHAR" property="idNumber" />
    <result column="sexy" jdbcType="INTEGER" property="sexy" />
    <result column="telephone" jdbcType="VARCHAR" property="telephone" />
    <result column="work_type" jdbcType="INTEGER" property="workType" />
    <result column="industry" jdbcType="INTEGER" property="industry" />
    <result column="electronic_number" jdbcType="VARCHAR" property="electronicNumber" />
    <result column="health" jdbcType="VARCHAR" property="health" />
    <result column="train" jdbcType="VARCHAR" property="train" />
    <result column="education" jdbcType="VARCHAR" property="education" />
    <result column="health_number" jdbcType="VARCHAR" property="healthNumber" />
    <result column="start_time" jdbcType="TIMESTAMP" property="startTime" />
    <result column="end_time" jdbcType="TIMESTAMP" property="endTime" />
    <result column="issuing_authority" jdbcType="VARCHAR" property="issuingAuthority" />
    <result column="photo" jdbcType="VARCHAR" property="photo" />
    <result column="we_chat_id" jdbcType="VARCHAR" property="weChatId" />
    <result column="operate_time" jdbcType="TIMESTAMP" property="operateTime" />
    <result column="operator" jdbcType="VARCHAR" property="operator" />
    <result column="operate_ip" jdbcType="VARCHAR" property="operateIp" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Sep 21 17:39:21 CST 2020.
    -->
    id, company_id, company_name, name, id_number, sexy, telephone, work_type, industry, 
    electronic_number, health, train, education, health_number, start_time, end_time, 
    issuing_authority, photo, we_chat_id, operate_time, operator, operate_ip
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Sep 21 17:39:21 CST 2020.
    -->
    select 
    <include refid="Base_Column_List" />
    from supervision_ca
    where id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Sep 21 17:39:21 CST 2020.
    -->
    delete from supervision_ca
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.example.upc.dataobject.SupervisionCa">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Sep 21 17:39:21 CST 2020.
    -->
    insert into supervision_ca (id, company_id, company_name, 
      name, id_number, sexy, 
      telephone, work_type, industry, 
      electronic_number, health, train, 
      education, health_number, start_time, 
      end_time, issuing_authority, photo, 
      we_chat_id, operate_time, operator, 
      operate_ip)
    values (#{id,jdbcType=INTEGER}, #{companyId,jdbcType=INTEGER}, #{companyName,jdbcType=VARCHAR}, 
      #{name,jdbcType=VARCHAR}, #{idNumber,jdbcType=VARCHAR}, #{sexy,jdbcType=INTEGER}, 
      #{telephone,jdbcType=VARCHAR}, #{workType,jdbcType=INTEGER}, #{industry,jdbcType=INTEGER}, 
      #{electronicNumber,jdbcType=VARCHAR}, #{health,jdbcType=VARCHAR}, #{train,jdbcType=VARCHAR}, 
      #{education,jdbcType=VARCHAR}, #{healthNumber,jdbcType=VARCHAR}, #{startTime,jdbcType=TIMESTAMP}, 
      #{endTime,jdbcType=TIMESTAMP}, #{issuingAuthority,jdbcType=VARCHAR}, #{photo,jdbcType=VARCHAR}, 
      #{weChatId,jdbcType=VARCHAR}, #{operateTime,jdbcType=TIMESTAMP}, #{operator,jdbcType=VARCHAR}, 
      #{operateIp,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.example.upc.dataobject.SupervisionCa">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Sep 21 17:39:21 CST 2020.
    -->
    insert into supervision_ca
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="companyId != null">
        company_id,
      </if>
      <if test="companyName != null">
        company_name,
      </if>
      <if test="name != null">
        name,
      </if>
      <if test="idNumber != null">
        id_number,
      </if>
      <if test="sexy != null">
        sexy,
      </if>
      <if test="telephone != null">
        telephone,
      </if>
      <if test="workType != null">
        work_type,
      </if>
      <if test="industry != null">
        industry,
      </if>
      <if test="electronicNumber != null">
        electronic_number,
      </if>
      <if test="health != null">
        health,
      </if>
      <if test="train != null">
        train,
      </if>
      <if test="education != null">
        education,
      </if>
      <if test="healthNumber != null">
        health_number,
      </if>
      <if test="startTime != null">
        start_time,
      </if>
      <if test="endTime != null">
        end_time,
      </if>
      <if test="issuingAuthority != null">
        issuing_authority,
      </if>
      <if test="photo != null">
        photo,
      </if>
      <if test="weChatId != null">
        we_chat_id,
      </if>
      <if test="operateTime != null">
        operate_time,
      </if>
      <if test="operator != null">
        operator,
      </if>
      <if test="operateIp != null">
        operate_ip,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=INTEGER},
      </if>
      <if test="companyId != null">
        #{companyId,jdbcType=INTEGER},
      </if>
      <if test="companyName != null">
        #{companyName,jdbcType=VARCHAR},
      </if>
      <if test="name != null">
        #{name,jdbcType=VARCHAR},
      </if>
      <if test="idNumber != null">
        #{idNumber,jdbcType=VARCHAR},
      </if>
      <if test="sexy != null">
        #{sexy,jdbcType=INTEGER},
      </if>
      <if test="telephone != null">
        #{telephone,jdbcType=VARCHAR},
      </if>
      <if test="workType != null">
        #{workType,jdbcType=INTEGER},
      </if>
      <if test="industry != null">
        #{industry,jdbcType=INTEGER},
      </if>
      <if test="electronicNumber != null">
        #{electronicNumber,jdbcType=VARCHAR},
      </if>
      <if test="health != null">
        #{health,jdbcType=VARCHAR},
      </if>
      <if test="train != null">
        #{train,jdbcType=VARCHAR},
      </if>
      <if test="education != null">
        #{education,jdbcType=VARCHAR},
      </if>
      <if test="healthNumber != null">
        #{healthNumber,jdbcType=VARCHAR},
      </if>
      <if test="startTime != null">
        #{startTime,jdbcType=TIMESTAMP},
      </if>
      <if test="endTime != null">
        #{endTime,jdbcType=TIMESTAMP},
      </if>
      <if test="issuingAuthority != null">
        #{issuingAuthority,jdbcType=VARCHAR},
      </if>
      <if test="photo != null">
        #{photo,jdbcType=VARCHAR},
      </if>
      <if test="weChatId != null">
        #{weChatId,jdbcType=VARCHAR},
      </if>
      <if test="operateTime != null">
        #{operateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="operator != null">
        #{operator,jdbcType=VARCHAR},
      </if>
      <if test="operateIp != null">
        #{operateIp,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.example.upc.dataobject.SupervisionCa">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Sep 21 17:39:21 CST 2020.
    -->
    update supervision_ca
    <set>
      <if test="companyId != null">
        company_id = #{companyId,jdbcType=INTEGER},
      </if>
      <if test="companyName != null">
        company_name = #{companyName,jdbcType=VARCHAR},
      </if>
      <if test="name != null">
        name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="idNumber != null">
        id_number = #{idNumber,jdbcType=VARCHAR},
      </if>
      <if test="sexy != null">
        sexy = #{sexy,jdbcType=INTEGER},
      </if>
      <if test="telephone != null">
        telephone = #{telephone,jdbcType=VARCHAR},
      </if>
      <if test="workType != null">
        work_type = #{workType,jdbcType=INTEGER},
      </if>
      <if test="industry != null">
        industry = #{industry,jdbcType=INTEGER},
      </if>
      <if test="electronicNumber != null">
        electronic_number = #{electronicNumber,jdbcType=VARCHAR},
      </if>
      <if test="health != null">
        health = #{health,jdbcType=VARCHAR},
      </if>
      <if test="train != null">
        train = #{train,jdbcType=VARCHAR},
      </if>
      <if test="education != null">
        education = #{education,jdbcType=VARCHAR},
      </if>
      <if test="healthNumber != null">
        health_number = #{healthNumber,jdbcType=VARCHAR},
      </if>
      <if test="startTime != null">
        start_time = #{startTime,jdbcType=TIMESTAMP},
      </if>
      <if test="endTime != null">
        end_time = #{endTime,jdbcType=TIMESTAMP},
      </if>
      <if test="issuingAuthority != null">
        issuing_authority = #{issuingAuthority,jdbcType=VARCHAR},
      </if>
      <if test="photo != null">
        photo = #{photo,jdbcType=VARCHAR},
      </if>
      <if test="weChatId != null">
        we_chat_id = #{weChatId,jdbcType=VARCHAR},
      </if>
      <if test="operateTime != null">
        operate_time = #{operateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="operator != null">
        operator = #{operator,jdbcType=VARCHAR},
      </if>
      <if test="operateIp != null">
        operate_ip = #{operateIp,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.example.upc.dataobject.SupervisionCa">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Sep 21 17:39:21 CST 2020.
    -->
    update supervision_ca
    set company_id = #{companyId,jdbcType=INTEGER},
      company_name = #{companyName,jdbcType=VARCHAR},
      name = #{name,jdbcType=VARCHAR},
      id_number = #{idNumber,jdbcType=VARCHAR},
      sexy = #{sexy,jdbcType=INTEGER},
      telephone = #{telephone,jdbcType=VARCHAR},
      work_type = #{workType,jdbcType=INTEGER},
      industry = #{industry,jdbcType=INTEGER},
      electronic_number = #{electronicNumber,jdbcType=VARCHAR},
      health = #{health,jdbcType=VARCHAR},
      train = #{train,jdbcType=VARCHAR},
      education = #{education,jdbcType=VARCHAR},
      health_number = #{healthNumber,jdbcType=VARCHAR},
      start_time = #{startTime,jdbcType=TIMESTAMP},
      end_time = #{endTime,jdbcType=TIMESTAMP},
      issuing_authority = #{issuingAuthority,jdbcType=VARCHAR},
      photo = #{photo,jdbcType=VARCHAR},
      we_chat_id = #{weChatId,jdbcType=VARCHAR},
      operate_time = #{operateTime,jdbcType=TIMESTAMP},
      operator = #{operator,jdbcType=VARCHAR},
      operate_ip = #{operateIp,jdbcType=VARCHAR}
    where id = #{id,jdbcType=INTEGER}
  </update>

  <resultMap extends="BaseResultMap" id="SupervisionCaParam" type="com.example.upc.controller.param.SupervisionCaParam">
    <result column="industry_name" jdbcType="VARCHAR" property="industryName" />
    <result column="ca_score" jdbcType="REAL" property="caScore" />
  </resultMap>

  <select id="countList" resultType="int">
    SELECT count(1)
    FROM supervision_ca
    WHERE company_id IN (
    SELECT id FROM (
    <if test="caParam.industryList.contains('industrialProducts')">SELECT a.*,b.id as a10_id,b.end_time as a10_time FROM (</if>
    <if test="caParam.industryList.contains('medicalBusiness')">SELECT a.*,b.id as a9_id,b.end_time as a9_time FROM (</if>
    <if test="caParam.industryList.contains('medicalProduce')">SELECT a.*,b.id as a8_id,b.end_time as a8_time FROM (</if>
    <if test="caParam.industryList.contains('cosmeticsUse')">SELECT a.*,b.id as a7_id,b.end_time as a7_time FROM (</if>
    <if test="caParam.industryList.contains('drugsProduce')">SELECT a.*,b.id as a6_id,b.end_time as a6_time FROM (</if>
    <if test="caParam.industryList.contains('drugsBusiness')">SELECT a.*,b.id as a5_id,b.end_time as a5_time FROM (</if>
    <if test="caParam.industryList.contains('foodProduce')">SELECT a.*,b.id as a4_id,b.end_time as a4_time FROM (</if>
    <if test="caParam.industryList.contains('smallWorkshop')">SELECT a.*,b.id as a3_id,b.end_time as a3_time FROM (</if>
    <if test="caParam.industryList.contains('smallCater')">SELECT a.*,b.id as a2_id,b.end_time as a2_time FROM (</if>
    <if test="caParam.industryList.contains('foodBusiness')">SELECT a.* ,b.id as a1_id,b.end_time as a1_time FROM (</if>
    SELECT id  FROM supervision_enterprise WHERE area IN
    <foreach close=")" collection="caParam.areaList" item="area" open="(" separator=",">#{area}</foreach>
    <if test="caParam.supervisor != null and caParam.supervisor != ''">AND FIND_IN_SET(#{caParam.supervisor},supervisor)</if>
    <if test="caParam.industryList.contains('foodBusiness')">) as a LEFT JOIN supervision_en_food_bu_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('smallCater')">)as a LEFT JOIN supervision_en_small_cater_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('smallWorkshop')">)as a LEFT JOIN supervision_en_small_workshop_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('foodProduce')">)as a LEFT JOIN supervision_en_food_pro_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('drugsBusiness')">)as a LEFT JOIN supervision_en_drugs_bu_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('drugsProduce')">)as a LEFT JOIN supervision_en_drugs_pro_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('cosmeticsUse')">)as a LEFT JOIN supervision_en_cosmetics_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('medicalProduce')">)as a LEFT JOIN supervision_en_medical_pro_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('medicalBusiness')">)as a LEFT JOIN supervision_en_medical_bu_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('industrialProducts')">)as a LEFT JOIN supervision_en_industrial_products_index as b on a.id =b.enterprise_id
    </if>
    ) as a
    <if test="caParam.userType != 'admin'">
    <trim prefix="WHERE" prefixOverrides="OR">
      <if test="caParam.industryList.contains('foodBusiness')">
        a1_id
      </if>
      <if test="caParam.industryList.contains('smallCater')">
        OR a2_id
      </if>
      <if test="caParam.industryList.contains('smallWorkshop')">
        OR a3_id
      </if>
      <if test="caParam.industryList.contains('foodProduce')">
        OR a4_id
      </if>
      <if test="caParam.industryList.contains('drugsBusiness')">
        OR a5_id
      </if>
      <if test="caParam.industryList.contains('drugsProduce')">
        OR a6_id
      </if>
      <if test="caParam.industryList.contains('cosmeticsUse')">
        OR a7_id
      </if>
      <if test="caParam.industryList.contains('medicalProduce')">
        OR a8_id
      </if>
      <if test="caParam.industryList.contains('medicalBusiness')">
        OR a9_id
      </if>
      <if test="caParam.industryList.contains('industrialProducts')">
        OR a10_id
      </if>
    </trim>
    </if>
    )
    <if test="caParam.companyName != null and caParam.companyName != ''">AND company_name LIKE CONCAT('%',#{caParam.companyName},'%') </if>
    <if test="caParam.name != null and caParam.name != ''">AND name LIKE CONCAT('%',#{caParam.name},'%')</if>
    <if test="caParam.education != null and caParam.education != ''">AND education = #{caParam.education}</if>
    <if test="caParam.sexy != null">AND sexy = #{caParam.sexy}</if>
    <if test="caParam.health != null and caParam.health != ''">AND health = #{caParam.health}</if>
    <if test="caParam.workType != null">AND work_type = #{caParam.workType} </if>
    <if test="caParam.healthNumber != null and caParam.healthNumber != ''">AND health_number  LIKE CONCAT('%',#{caParam.healthNumber},'%') </if>
    <if test="caParam.startTime != null">  AND end_time &gt;= #{caParam.startTime}</if>
    <if test="caParam.endTime != null"> AND end_time &lt;= #{caParam.endTime}</if>
  </select>

  <select id="getPage" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM supervision_ca
    WHERE company_id IN (
    SELECT id FROM (
    <if test="caParam.industryList.contains('industrialProducts')">SELECT a.*,b.id as a10_id,b.end_time as a10_time FROM (</if>
    <if test="caParam.industryList.contains('medicalBusiness')">SELECT a.*,b.id as a9_id,b.end_time as a9_time FROM (</if>
    <if test="caParam.industryList.contains('medicalProduce')">SELECT a.*,b.id as a8_id,b.end_time as a8_time FROM (</if>
    <if test="caParam.industryList.contains('cosmeticsUse')">SELECT a.*,b.id as a7_id,b.end_time as a7_time FROM (</if>
    <if test="caParam.industryList.contains('drugsProduce')">SELECT a.*,b.id as a6_id,b.end_time as a6_time FROM (</if>
    <if test="caParam.industryList.contains('drugsBusiness')">SELECT a.*,b.id as a5_id,b.end_time as a5_time FROM (</if>
    <if test="caParam.industryList.contains('foodProduce')">SELECT a.*,b.id as a4_id,b.end_time as a4_time FROM (</if>
    <if test="caParam.industryList.contains('smallWorkshop')">SELECT a.*,b.id as a3_id,b.end_time as a3_time FROM (</if>
    <if test="caParam.industryList.contains('smallCater')">SELECT a.*,b.id as a2_id,b.end_time as a2_time FROM (</if>
    <if test="caParam.industryList.contains('foodBusiness')">SELECT a.* ,b.id as a1_id,b.end_time as a1_time FROM (</if>
    SELECT id  FROM supervision_enterprise WHERE area IN
    <foreach close=")" collection="caParam.areaList" item="area" open="(" separator=",">#{area}</foreach>
    <if test="caParam.supervisor != null and caParam.supervisor != ''">AND FIND_IN_SET(#{caParam.supervisor},supervisor)</if>
    <if test="caParam.industryList.contains('foodBusiness')">) as a LEFT JOIN supervision_en_food_bu_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('smallCater')">)as a LEFT JOIN supervision_en_small_cater_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('smallWorkshop')">)as a LEFT JOIN supervision_en_small_workshop_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('foodProduce')">)as a LEFT JOIN supervision_en_food_pro_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('drugsBusiness')">)as a LEFT JOIN supervision_en_drugs_bu_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('drugsProduce')">)as a LEFT JOIN supervision_en_drugs_pro_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('cosmeticsUse')">)as a LEFT JOIN supervision_en_cosmetics_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('medicalProduce')">)as a LEFT JOIN supervision_en_medical_pro_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('medicalBusiness')">)as a LEFT JOIN supervision_en_medical_bu_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('industrialProducts')">)as a LEFT JOIN supervision_en_industrial_products_index as b on a.id =b.enterprise_id
    </if>
    ) as a
    <if test="caParam.userType != 'admin'">
    <trim prefix="WHERE" prefixOverrides="OR">
      <if test="caParam.industryList.contains('foodBusiness')">
        a1_id
      </if>
      <if test="caParam.industryList.contains('smallCater')">
        OR a2_id
      </if>
      <if test="caParam.industryList.contains('smallWorkshop')">
        OR a3_id
      </if>
      <if test="caParam.industryList.contains('foodProduce')">
        OR a4_id
      </if>
      <if test="caParam.industryList.contains('drugsBusiness')">
        OR a5_id
      </if>
      <if test="caParam.industryList.contains('drugsProduce')">
        OR a6_id
      </if>
      <if test="caParam.industryList.contains('cosmeticsUse')">
        OR a7_id
      </if>
      <if test="caParam.industryList.contains('medicalProduce')">
        OR a8_id
      </if>
      <if test="caParam.industryList.contains('medicalBusiness')">
        OR a9_id
      </if>
      <if test="caParam.industryList.contains('industrialProducts')">
        OR a10_id
      </if>
    </trim>
    </if>
    )
    <if test="caParam.companyName != null and caParam.companyName != ''">AND company_name LIKE CONCAT('%',#{caParam.companyName},'%') </if>
    <if test="caParam.name != null and caParam.name != ''">AND name LIKE CONCAT('%',#{caParam.name},'%')</if>
    <if test="caParam.education != null and caParam.education != ''">AND education = #{caParam.education}</if>
    <if test="caParam.sexy != null">AND sexy = #{caParam.sexy}</if>
    <if test="caParam.health != null and caParam.health != ''">AND health = #{caParam.health}</if>
    <if test="caParam.workType != null">AND work_type = #{caParam.workType} </if>
    <if test="caParam.healthNumber != null and caParam.healthNumber != ''">AND health_number  LIKE CONCAT('%',#{caParam.healthNumber},'%') </if>
    <if test="caParam.startTime != null">  AND end_time &gt;= #{caParam.startTime}</if>
    <if test="caParam.endTime != null"> AND end_time &lt;= #{caParam.endTime}</if>
    ORDER BY id DESC
    limit #{page.offset}, #{page.pageSize}
  </select>

  <select id="selectByInfor" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    select *
    from supervision_ca
    where info_id = #{info}
  </select>

  <insert id="batchInsert" keyColumn="id" keyProperty="id" parameterType="map" useGeneratedKeys="true">
    insert into supervision_ca (id,company_id, company_name, name,id_number,sexy,telephone,work_type,industry,electronic_number,
    health,train,education,health_number,start_time,end_time,issuing_authority,operator, operate_time, operate_ip)
    values
    <foreach collection="supervisionCaList" item="supervisionCa" separator=",">
      ( #{supervisionCa.id},#{supervisionCa.companyId}, #{supervisionCa.companyName},#{supervisionCa.name},#{supervisionCa.idNumber},#{supervisionCa.sexy}
      ,#{supervisionCa.telephone},#{supervisionCa.workType},#{supervisionCa.industry},#{supervisionCa.electronicNumber}
      ,#{supervisionCa.health},#{supervisionCa.train},#{supervisionCa.education},#{supervisionCa.healthNumber},
      #{supervisionCa.startTime},#{supervisionCa.endTime},#{supervisionCa.issuingAuthority}
      ,#{supervisionCa.operator}, #{supervisionCa.operateTime}, #{supervisionCa.operateIp})
    </foreach>
  </insert>

  <select id="countListByTrain" resultType="int">
    SELECT count(1)
    FROM supervision_ca
    WHERE company_id IN (
    SELECT id FROM (
    <if test="caParam.industryList.contains('industrialProducts')">SELECT a.*,b.id as a10_id,b.end_time as a10_time FROM (</if>
    <if test="caParam.industryList.contains('medicalBusiness')">SELECT a.*,b.id as a9_id,b.end_time as a9_time FROM (</if>
    <if test="caParam.industryList.contains('medicalProduce')">SELECT a.*,b.id as a8_id,b.end_time as a8_time FROM (</if>
    <if test="caParam.industryList.contains('cosmeticsUse')">SELECT a.*,b.id as a7_id,b.end_time as a7_time FROM (</if>
    <if test="caParam.industryList.contains('drugsProduce')">SELECT a.*,b.id as a6_id,b.end_time as a6_time FROM (</if>
    <if test="caParam.industryList.contains('drugsBusiness')">SELECT a.*,b.id as a5_id,b.end_time as a5_time FROM (</if>
    <if test="caParam.industryList.contains('foodProduce')">SELECT a.*,b.id as a4_id,b.end_time as a4_time FROM (</if>
    <if test="caParam.industryList.contains('smallWorkshop')">SELECT a.*,b.id as a3_id,b.end_time as a3_time FROM (</if>
    <if test="caParam.industryList.contains('smallCater')">SELECT a.*,b.id as a2_id,b.end_time as a2_time FROM (</if>
    <if test="caParam.industryList.contains('foodBusiness')">SELECT a.* ,b.id as a1_id,b.end_time as a1_time FROM (</if>
    SELECT id  FROM supervision_enterprise WHERE area IN
    <foreach close=")" collection="caParam.areaList" item="area" open="(" separator=",">#{area}</foreach>
    <if test="caParam.supervisor != null and caParam.supervisor != ''">AND FIND_IN_SET(#{caParam.supervisor},supervisor)</if>
    <if test="caParam.industryList.contains('foodBusiness')">) as a LEFT JOIN supervision_en_food_bu_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('smallCater')">)as a LEFT JOIN supervision_en_small_cater_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('smallWorkshop')">)as a LEFT JOIN supervision_en_small_workshop_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('foodProduce')">)as a LEFT JOIN supervision_en_food_pro_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('drugsBusiness')">)as a LEFT JOIN supervision_en_drugs_bu_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('drugsProduce')">)as a LEFT JOIN supervision_en_drugs_pro_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('cosmeticsUse')">)as a LEFT JOIN supervision_en_cosmetics_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('medicalProduce')">)as a LEFT JOIN supervision_en_medical_pro_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('medicalBusiness')">)as a LEFT JOIN supervision_en_medical_bu_index as b on a.id =b.enterprise_id
    </if>
    <if test="caParam.industryList.contains('industrialProducts')">)as a LEFT JOIN supervision_en_industrial_products_index as b on a.id =b.enterprise_id
    </if>
    ) as a
    <trim prefix="WHERE" prefixOverrides="OR">
      <if test="caParam.industryList.contains('foodBusiness')">
        a1_id
      </if>
      <if test="caParam.industryList.contains('smallCater')">
        OR a2_id
      </if>
      <if test="caParam.industryList.contains('smallWorkshop')">
        OR a3_id
      </if>
      <if test="caParam.industryList.contains('foodProduce')">
        OR a4_id
      </if>
      <if test="caParam.industryList.contains('drugsBusiness')">
        OR a5_id
      </if>
      <if test="caParam.industryList.contains('drugsProduce')">
        OR a6_id
      </if>
      <if test="caParam.industryList.contains('cosmeticsUse')">
        OR a7_id
      </if>
      <if test="caParam.industryList.contains('medicalProduce')">
        OR a8_id
      </if>
      <if test="caParam.industryList.contains('medicalBusiness')">
        OR a9_id
      </if>
      <if test="caParam.industryList.contains('industrialProducts')">
        OR a10_id
      </if>
    </trim>
    )
    <if test="trainStatus != null and trainStatus != ''">AND train = #{trainStatus}</if>
  </select>

  <select id="countTrainByEnterprise" resultType="int">
    SELECT count(1)
    FROM supervision_ca
    WHERE company_id = #{id}
    AND train = #{trainStatus}
  </select>

  <select id="getPageByEnterprise" resultMap="BaseResultMap">
  SELECT
    *
  FROM supervision_ca
  where company_id = #{enterprise}
    limit #{page.offset}, #{page.pageSize}
</select>

  <select id="getAllByEnterpriseId" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM supervision_ca
    where company_id = #{enterpriseId}
  </select>

  <select id="countListByEnterprise" resultType="int">
    SELECT count(1)
    FROM supervision_ca
    where company_id = #{enterprise}
  </select>

  <select id="countByIdNumber" parameterType="map" resultType="int">
    SELECT count(1)
    FROM supervision_ca
    WHERE id_number = #{idNumber}
    <if test="id != null">
      AND id != #{id}
    </if>
  </select>

  <delete id="batchDelete" parameterType="map">
    delete from supervision_ca where id in
    <foreach close=")" collection="caIds" index="no" item="caId" open="(" separator=",">
      #{caId}
    </foreach>
  </delete>

  <select id="getAll" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM supervision_ca
  </select>

  <select id="countListNameByEnterpriseId" resultType="int">
    SELECT count(1)
    FROM supervision_ca
    WHERE  company_id = #{id}
    <if test="search.name != null and search.name != ''">AND name LIKE CONCAT('%',#{search.name},'%')</if>
  </select>

  <select id="getNameByEnterpriseId" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM supervision_ca
    where company_id = #{id}
    <if test="search.name != null and search.name != ''">AND name LIKE CONCAT('%',#{search.name},'%')</if>
    ORDER BY end_time DESC
    limit #{page.offset}, #{page.pageSize}
  </select>

  <select id="getAllByEnterpriseId2" resultMap="SupervisionCaParam">
    SELECT *
    FROM view_supervision_ca
    where company_id = #{enterpriseId}
    ORDER BY id DESC
  </select>

  <select id="getCaInfoByUserId" resultMap="BaseResultMap">
    select * From view_supervision_ca where user_id=#{userId}
  </select>

  <select id="getCaInfoByIdNumber" resultMap="BaseResultMap">
    select * From supervision_ca WHERE id_number = #{idNumber}
  </select>

  <select id="getCaInfoByWeChatId" resultMap="BaseResultMap">
    select * From supervision_ca WHERE we_chat_id = #{weChatId}
  </select>
</mapper>